<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{user/layout/login_default}">
<!--로그인 후 볼 수 있는 유저 마이 페이지-->
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.1/font/bootstrap-icons.css">
    <style>
        .login-logo .user-connection-menu {
            display: none;
        }
        #tabWrapper {
            background-color: white;
            display: flex;
            justify-content: center;
            overflow: hidden;
            padding-top: 30px;
        }

        #tabContainer {
            width: 1040px;
        }

        .nav-link{
            font-size: medium;
        }

        #profileContainer{
            display: flex;
            justify-content: center;
            padding: 35px;
            flex-direction: column;
        }

        .img-box{
            margin: 0 auto;
        }

        #name-box{
            display: flex;
            justify-content: center;
            flex-direction: row;
        }

        /*  tab의 내부 영역 시작 */
        .titleContainer{
            /*display : flex;*/
            flex-direction: column;
            /*height : 150px;*/
            justify-content: start;
            padding: 30px 0 20px 30px;

        }

        /* tab 내부의 타이틀 영역 */
        .tabTitle{
            display : flex;
            height : 50px;
            flex-direction: column;
            justify-content: start;
            font-size : 30px;
            font-weight: bold;
            margin-bottom: 30px;
            color:black; !important;
        }

        /* 셀렉트 포함한 div */
        #selectContainer{
            display: flex;
            width: 250px;
            height: 50px;
        }

        #selectFund{
            font-size:16px;
            padding:10px 70px 10px 10px;
            color:dimgray;
        }

        /* tab 내부의 본문 영역 */
        .bodyContainer{
            display : flex;
            flex-direction: column;
            padding: 30px;
        }

        /* 내역 리스트 항목  */
        .contentsContainer{
            margin-bottom: 10px;
            display:flex;
            align-items: center;
            flex-direction: column;
        }

        /*  검은 버튼  */
        .submitBtn_black {
            background: #191919;
            padding: 7px 23px;
            transition: all .4s;
            color: #fff;
            display: inline-block;
            text-decoration: none;
            border: 1px solid #191919;
            font-size: 12px;
            transition: background 0.3s;
            margin-left: 7px;
        }

        .submitBtn_black:hover {
            background: var(--maincolor);
            border: 1px solid var(--maincolor);
        }

        .submitBtn_black:disabled{
            background-color: lightgrey;
            border: 1px solid lightgrey;
        }

        /* 흰 버튼 */
        .submitBtn_white {
            background: #fff;
            padding: 7px 23px;
            transition: all .4s;
            color: #191919;
            display: inline-block;
            text-decoration: none;
            border: 1px solid #191919;
            font-size: 12px;
            transition: background 0.3s;
            margin-left: 7px;
        }

        .submitBtn_white:hover {
            background: var(--maincolor);
            border: 1px solid var(--maincolor);
            color: #fff;
        }

        /* 흰 버튼 */
        .submitBtn_blue {
            background: var(--maincolor);
            padding: 7px 23px;
            transition: all .4s;
            color: #fff;
            display: inline-block;
            text-decoration: none;
            border: 1px solid #191919;
            font-size: 12px;
            transition: background 0.3s;
            margin-left: 7px;
        }

        .submitBtn_blue:hover {
            background: #fff;
            border: 1px solid #191919;;
            color: #191919;
        }

        .nav-link{
            padding:10px 60px 0 60px;
        }

        .user-info{
            width: 400px;
            display: flex;
            flex-direction: row;
            justify-content: space-between;
            color:black;
            padding-left: 10px;
        }

        .h4 pb-2 mb-4 text-danger border-bottom border-grey{
            height: 80px ;
        }
        .user-info-list{
            font-weight: bold;
            font-size: medium;
            color: black;
        }

        /* 회원 탈퇴 a 태그*/
        #lead-drop-page {
            color: lightgrey;
        }

        #lead-drop-page:hover {
            color: black; /* 포커싱될 때 글자 색상을 검은색으로 변경 */
        }

        .hidden{
            display: none;
        }

        .btn.btn-secondary.btn-sm{
            background-color: lightgrey;
            border: 1px solid white;
            border-radius: 5px;
        }
        input::placeholder,.form-control {
            font-size: 14px; /* 원하는 글꼴 크기로 조절 */
            color: lightgrey;
        }

    </style>

</head>
<body>
<!--사용자별 html-->
<th:block layout:fragment="customContents">
    <!-- 유저 프로필 영역   -->
    <div id="profileContainer">
        <!-- 프로필 이미지 -->
        <div class="img-box">
            <img style="width: 90px; height: 90px; border-radius: 50%;" src="https://search.pstatic.net/sunny/?src=https%3A%2F%2Fi.namu.wiki%2Fi%2FDgDM89CJAmUv4KwG-JNwQOWklX6MPKPXip-KQL66igwbwegZ3y6pRdFZ3Ne28Qn7JaxXZzewB3_iHM_uqJ7s8A.webp&type=sc960_832"
                 id="profile_img" alt="">
        </div>

        <!-- 사용자 이름 + 설정 아이콘 -->
        <div id="name-box">
            <!-- 사용자 이름 -->
            <h2>최미미</h2>
            <!-- 설정 아이콘 클릭시 프로필 설정 페이지로 이동  -->
            <a th:href="@{/user/mypage/profile}"><i class="bi bi-gear" id="showProfileIcon" ></i></a>
        </div>
    </div>
    <!-- tab 메뉴 영역  -->
    <!-- data-toggle="tab" 속성을 Bootstrap의 <a> 태그에 추가하면 해당 링크가 tab 컴포넌트를 제어하도록 설정 -->
    <div id="tabWrapper">
        <div id="tabContainer">
            <ul class="nav nav-tabs nav-justified justify-content-center" id="tabList">
                <li class="nav-item"><a href="#menu1" class="nav-link active" data-toggle="tab">후원한 펀딩</a></li>
                <li class="nav-item"><a href="#menu2" class="nav-link " data-toggle="tab">찜한 펀딩</a></li>
                <li class="nav-item"><a href="#menu5" class="nav-link" data-toggle="tab">적립금/쿠폰/</a></li>
                <li class="nav-item"><a href="#menu6" class="nav-link" data-toggle="tab">내 정보</a></li>
            </ul>

    <!-- tab 내에 표시될 영역  -->
            <div class="tab-content" >
                <div id="menu1" class="container tab-pane active">
                    <!--  tab 내부 타이틀 영역 -->
                    <div class="titleContainer" >
                        <div class="tabTitle">펀딩 내역</div>

                    <!--  펀딩 종류 select  -->
                    <div id="selectContainer">
                        <select id="selectFund" class="form-select form-select-lg" >
                            <option class="fundCategory" value="viewAll">전체</option>
                            <option class="fundCategory" value="reward">리워드</option>
                            <option class="fundCategory" value="investment">투자</option>
                            <option class="fundCategory" value="donation">기부</option>
                        </select>
                    </div>

                    </div >
                    <!--  리워드 펀딩 선택시 나타날 페이지  -->
                    <!--  tab 내부 본문 영역 -->
                    <div class="bodyContainer" id="orderProject">
                        <!--  내역 리스트 항목 -->
                        <div class="contentsContainer mb-lg-5" th:each="l : ${mypageOrderList}">
                            <div class="card" style="width: 48rem;">
                                <!-- 내역 상태 ( 주문 상태 상세 )  -->
                                <h5 class="card-header" th:text="${l.orderCategoryDetail}"></h5>
                                <!-- 내역 내용 -->
                                <div class="card-body" style="display: flex">
                                    <!-- 이미지  -->
                                    <div>
                                        <img class="card-img-top" style="width: 160px; height: 160px;" alt="..." th:src="|@{/summernoteImage/}${l.projectThumbnailImage}|"
                                             onerror="this.src = 'https://as1.ftcdn.net/v2/jpg/04/34/72/82/1000_F_434728286_OWQQvAFoXZLdGHlObozsolNeuSxhpr84.jpg';">
                                    </div>

                                    <!-- 설명 / 버튼 -->
                                    <form action="" method="post" style="display: flex; flex-direction: column; justify-content:space-between; padding-left:30px; width: 1200px;">
                                            <p class="orderApplicationDate" th:text="${l.orderApplicationDate}">2023.10.30 결제</p>
                                            <h5 class="orderName" th:text="${l.orderFundingName}">[9만원대 | 가성비 끝판왕] 누젠 모래시계 가열식 가습기</h5>
                                            <th:block th:if="${#lists.size(rl) > 0}" th:each="rl : ${l.rewardOrderDetailList}">
                                                <span class="card-text" th:text="${rl.optionName}">누젠 모래시계 가열식 가습기(화이트)</span>
                                                <span th:text="|주문 수량 : ${rl.orderOptionAmount} 개|"></span>
                                            </th:block>
                                            <div style="display: flex; justify-content: end; margin:0;">
                                                <th:block th:if="${l.orderCategoryCode =='ORDC_001'}">
                                                    <!--리워드 프로젝트 주문 완료-->
                                                    <a th:href="@{/user/mypage/reward/orderConfirm(orderCode=${l.orderCode})}" class="confirmBtn submitBtn_blue">구매 확정</a>
                                                    <a th:href="@{/user/mypage/reward/detailInfo(orderCode=${l.orderCode})}" class="payDetailBtn submitBtn_white">결제 내역</a>
                                                    <a th:href="@{/user/mypage/reward/cancel(orderCode=${l.orderCode})}" class="orderCancelBtn submitBtn_black">주문 취소</a>
                                                </th:block>
                                                <th:block th:if="${l.orderCategoryCode =='ORDC_002'}">
                                                    <!--기부 프로젝트 주문 완료-->
                                                    <a href="#" class="payDetailBtn submitBtn_white" >기부 내역</a>
                                                    <!--기부 취소는 기부 주문 후 7일 이내 가능하도록.-->
                                                    <a href="#" class="payDetailBtn orderCancelBtn submitBtn_black">기부 취소</a>
                                                </th:block>
                                                <th:block th:if="${l.orderCategoryCode =='ORDC_003'}">
                                                    <!--투자 프로젝트 주문 완료, 청약 신청 중-->
                                                    <a href="#" class="submitBtn_white">투자 현황</a>
                                                    <a href="#" class="payDetailBtn submitBtn_white">투자 내역</a>
                                                    <a href="#" class="orderCancelBtn submitBtn_black">투자 취소</a>
                                                </th:block>
                                                <th:block th:if="${l.orderCategoryCode =='ORDC_004'}">
                                                    <!--리워드 배송 대기-->
                                                    <a href="#" class="confirmBtn submitBtn_white" >구매 확정</a>
                                                    <a href="#" class="payDetailBtn submitBtn_white" >결제 내역</a>
                                                    <a href="#" class="orderCancelBtn submitBtn_black" data-toggle="modal" data-target="#exampleModal3" data-what="hello">주문 취소</a>
                                                </th:block>
                                                <th:block th:if="${l.orderCategoryCode =='ORDC_015'}">
                                                    <!--리워드 배송 중-->
                                                    <a th:href="@{/user/mypage/reward/orderConfirm(orderCode=${l.orderCode})}" class="confirmBtn submitBtn_blue">구매 확정</a>
                                                    <a href="#" class="submitBtn_white" >배송 정보</a>
                                                    <a th:href="@{/user/mypage/reward/detailInfo(orderCode=${l.orderCode})}" class="payDetailBtn submitBtn_white">결제 내역</a>
                                                </th:block>
                                                <th:block th:if="${l.orderCategoryCode =='ORDC_005'}">
                                                    <!--리워드 배송 완료-->
                                                    <a th:href="@{/user/mypage/reward/orderConfirm(orderCode=${l.orderCode})}" class="confirmBtn submitBtn_blue">구매 확정</a>
                                                    <a th:href="@{/user/mypage/reward/detailInfo(orderCode=${l.orderCode})}" class="payDetailBtn submitBtn_white">결제 내역</a>
                                                    <a th:href="@{/user/mypage/refund}" class="submitBtn_black" >환불 신청</a>
                                                    <a th:href="@{/user/mypage/refund/cancel}" class="submitBtn_black" >교환 신청</a>
                                                </th:block>
                                                <th:block th:if="${l.orderCategoryCode =='ORDC_006'}">
                                                    <!--리워드 주문 확정-->
                                                    <a th:href="@{/user/mypage/reward/detailInfo(orderCode=${l.orderCode})}" class="payDetailBtn submitBtn_white">결제 내역</a>
                                                </th:block>
                                                <th:block th:if="${l.orderCategoryCode =='ORDC_007'}">
                                                    <!--기부 주문 확정-->
                                                    <a href="#" class="submitBtn_white" >기부 현황</a>
                                                    <a href="#" class="submitBtn_white" >기부 상세</a>
                                                </th:block>
                                                <th:block th:if="${l.orderCategoryCode =='ORDC_008'}">
                                                    <!--투자 주문 확정, 납입일 도래-->
                                                    <a href="#" class="submitBtn_white" >투자 현황</a>
                                                    <a href="#" class="submitBtn_white" >투자 상세</a>
                                                </th:block>
                                                <th:block th:if="${l.orderCategoryCode =='ORDC_009'}">
                                                    <!--리워드 환불 진행 중-->
                                                    <a href="#" class="submitBtn_white" >환불 상세</a>
                                                    <a th:href="@{/user/mypage/reward/detailInfo(orderCode=${l.orderCode})}" class="payDetailBtn submitBtn_white">결제 내역</a>
                                                </th:block>
                                                <th:block th:if="${l.orderCategoryCode =='ORDC_010'}">
                                                    <!--리워드 환불 처리 완료-->
                                                    <a href="#" class="submitBtn_white" >환불 내역</a>
                                                    <a th:href="@{/user/mypage/reward/detailInfo(orderCode=${l.orderCode})}" class="payDetailBtn submitBtn_white">결제 내역</a>
                                                </th:block>
                                                <th:block th:if="${l.orderCategoryCode =='ORDC_011'}">
                                                    <!--리워드 교환 진행 중-->
                                                    <a href="#" class="submitBtn_white" >교환 상세</a>
                                                    <a th:href="@{/user/mypage/reward/detailInfo(orderCode=${l.orderCode})}" class="payDetailBtn submitBtn_white">결제 내역</a>
                                                </th:block>
                                                <th:block th:if="${l.orderCategoryCode =='ORDC_012'}">
                                                    <!--리워드 교환 완료-->
                                                    <a href="#" class="submitBtn_white" >교환 내역</a>
                                                    <a th:href="@{/user/mypage/reward/detailInfo(orderCode=${l.orderCode})}" class="payDetailBtn submitBtn_white">결제 내역</a>
                                                </th:block>
                                                <th:block th:if="${l.orderCategoryCode =='ORDC_013'}">
                                                    <!--리워드 프로젝트 실패로 주문 취소-->
                                                    <a th:href="@{/user/mypage/reward/detailInfo(orderCode=${l.orderCode})}" class="payDetailBtn submitBtn_white">취소 내역</a>
                                                    <a th:href="@{/user/mypage/reward/detailInfo(orderCode=${l.orderCode})}" class="payDetailBtn submitBtn_white">결제 내역</a>
                                                </th:block>
                                                <th:block th:if="${l.orderCategoryCode =='ORDC_014'}">
                                                    <!--리워드 구매자 신청으로 주문 취소-->
                                                    <a th:href="@{/user/mypage/reward/detailInfo(orderCode=${l.orderCode})}" class="payDetailBtn submitBtn_white">취소 내역</a>
                                                    <a th:href="@{/user/mypage/reward/detailInfo(orderCode=${l.orderCode})}" class="payDetailBtn submitBtn_white">결제 내역</a>
                                                </th:block>
                                            </div>
                                    </form>
                                </div>
                            </div>
                        </div>

                        <!-- 모달팝업 -->
                        <div class="modal fade" id="exampleModal3" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                            <div class="modal-dialog" role="document">
                                <div class="modal-content">

                                    <!-- 팝업창 내용 -->
                                    <div class="modal-body detail">
                                        <p>정말로 취소하시겠습니까?</p>
                                    </div>

                                    <div class="modal-footer" >
                                        <button type="submit" class="submitBtn_white" data-dismiss="modal">취소</button>
                                        <button type="submit" class="submitBtn_black">확인</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="menu2" class="container tab-pane ">
                    <div class="titleContainer">
                        <div class="tabTitle">찜한 펀딩</div>
                    </div>
                </div>


                <div id="menu5" class="container tab-pane">
                    <div class="titleContainer">
                        <div class="tabTitle">적립급/쿠폰</div>
                    </div>
                </div>

                <div id="menu6" class="container tab-pane" style="" >
                    <div class="titleContainer" >
                        <div class="tabTitle">내 정보</div>
                        <div style=" display: flex; flex-direction: column;
                        justify-content: center; align-items: center;">

                            <form class="join-form">
                                <div class="mb-6">
                                    <p class="user-info-list">ID</p>
                                    <div class="user-info">
                                    <div>id001</div>
                                    </div>
                                </div>
                                <div class="h4 pb-2 mb-4 text-danger border-bottom border-grey" style="width: auto"></div>
                                <!--  비밀번호 정보 -->
                                <div class="mb-6" style="display: flex; justify-content: space-between;" >
                                    <p class="user-info-list">비밀번호</p>
                                    <button id="edit-pw-btn" type="button" data-target="edit-pw" class="btn btn-secondary btn-sm">변경</button>
                                </div>
                                <!-- 변경 버튼의 target (변경 버튼 클릭시 edit-pw div가 floating)  -->
                                <div id="edit-pw" class="info-box" style="margin: 10px 50px 0 50px; display: none;">
                                    <!--  기존 비밀번호   -->
                                    <p>현재 비밀번호 확인</p>
                                    <input class="form-control" type="password" placeholder="비밀번호 입력" id="floating-input"
                                           style="height: 10px; border: 1px solid black; margin: 15px 40px 10px 15px;"/>
                                    <div id="pw-auth-alert" class="form-text" style="color:red; font-size:13px; margin: 0 0 5px 15px;"></div>
                                    <button id="pw-check-btn" type="button" class="submitBtn_black" style="margin-left:15px; margin-bottom: 10px;">확인</button>
                                    <!--  새로운 비밀번호   -->
                                    <p>새로운 비밀번호</p>
                                    <input class="form-control" type="password" placeholder="새로운 비밀번호" id="new-pw"
                                           style="height: 10px; border: 1px solid black; margin: 15px 40px 15px 15px;"/>
                                    <input class="form-control" type="password" placeholder="새로운 비밀번호 확인" id="new-pw-check"
                                           style="height: 10px; border: 1px solid black; margin: 15px 40px 10px 15px;"/>
                                    <div id="pw-check-alert" class="form-text" style="color:red; font-size:13px; margin: 0 0 5px 15px;" ></div>
                                    <button id="pw-edit-btn" type="button" class="submitBtn_black" style="margin-left:15px; margin-bottom: 10px;" disabled>저장</button>
                                </div>

                                <!--  e-mail 정보 -->
                                <div class="h4 pb-2 mb-4 text-danger border-bottom border-grey" style="width: auto"></div>
                                <div class="mb-6">
                                    <div style="display: flex; justify-content: space-between;">
                                        <p class="user-info-list">e-mail</p>
                                        <button id="edit-email-btn" type="button" data-target="edit-email" class="btn btn-secondary btn-sm edit" >변경</button>
                                    </div>
                                    <div>
                                        <div id="edit-email" class="info-box" style="margin: 10px 50px 0 50px; display:none;">
                                            <input class="form-control" placeholder="이메일 입력" id="email-input"
                                                   style="height: 10px; border: 1px solid black; margin: 15px 40px 10px 15px;"/>
                                            <div id="email-alert" class="form-text" style="color:red; font-size:13px; margin: 0 0 5px 15px;"></div>
                                            <button id="email-edit-btn" type="button" class="submitBtn_black" style="margin-left:15px; margin-bottom: 10px;">저장</button>
                                        </div>
                                    </div>
                                    <div class="user-info">
                                        <div class="existing-value" th:text="${memberEmail}"></div>
                                    </div>
                                </div>


                                <div class="h4 pb-2 mb-4 text-danger border-bottom border-grey" style="width: auto"></div>

                                <!--  3️⃣ 휴대폰 번호 정보 -->
                                <div class="mb-6">
                                    <div style="display: flex; justify-content: space-between;">
                                        <p class="user-info-list">휴대폰 번호</p>
                                        <!-- 변경 버튼 클릭시 edit-pw div가 floating  -->
                                        <button id="edit-phone-btn" type="button" data-target="edit-phone" class="btn btn-secondary btn-sm edit">변경</button>
                                    </div>
                                    <div>
                                        <div id="edit-phone" class="info-box" style="margin: 10px 50px 0 50px; display: none;">
                                            <input class="form-control" placeholder="휴대폰 번호 입력" id="phone-input"
                                                   style="height: 10px; border: 1px solid black; margin: 15px 40px 10px 15px;"/>
                                            <div id="phone-alert" class="form-text" style="color:red; font-size:13px; margin: 0 0 5px 15px;"></div>
                                            <button id="phone-edit-btn" type="button" class="submitBtn_black" style="margin-left:15px; margin-bottom: 10px;">저장</button>
                                        </div>
                                    </div>
                                    <div class="user-info">
                                        <div>010-1111-1111</div>
                                    </div>
                                </div>

                                <div class="h4 pb-2 mb-4 text-danger border-bottom border-grey" style="width: auto"></div>
                                <div class="mb-6">
                                    <a id="lead-drop-page" th:href="@{/user/account/drop}">회원탈퇴</a>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>


</th:block>

<!-- 사용자별 스크립트 파일 -->
<th:block layout:fragment="customJsFile">

</th:block>

<!-- 사용자별 스크립트 작성 -->
<th:block layout:fragment="customJsCode">

    <script type="text/javascript" th:inline="javascript">
        /* 선택한 select 항목별로 내용 나타나게  */
        /* 일단 모든 항목을 숨기고 나타나게 해야 할 듯 */
        $rewardTab = document.getElementById('rewardTab');
        $investmentTab = document.getElementById('investmentTab');
        $selectFund = document.getElementById('selectFund');
        $donationTab = document.getElementById('donationTab');
        $bodyContainer = document.querySelectorAll('.bodyContainer');



        document.getElementById('lead-drop-page').addEventListener('focus', ()=>{
        })


        /* 내 정보 tab 🔽 */
        /* 비밀번호 변경 버튼 클릭시 div 보이게 */
        const $editPwBtn = document.getElementById('edit-pw-btn');
        const $pwEditDiv = document.getElementById('edit-pw')
        $editPwBtn.addEventListener('click',function(){
            if($pwEditDiv.style.display === 'none'){
                $pwEditDiv.style.display = 'block';
                this.style.backgroundColor = 'white';
                this.style.color ='black';
                this.textContent = '취소';
            }else{
                $pwEditDiv.style.display = 'none';
                this.style.backgroundColor = 'lightgrey';
                this.style.color ='white';
                this.textContent = '변경';
            }
        })

        /*  이메일 + 연락처 변경 버튼 클릭시 숨겨진 div 보이게 */
        const $editBtns = document.querySelectorAll('.btn.btn-secondary.btn-sm.edit');
        $editBtns.forEach(function (button){
            button.addEventListener('click',()=>{
                /* data-target 속성 이용하여 특정 버튼과 연결된 숨겨진 div 식별*/
                const $targetDivId = button.getAttribute('data-target');
                const $targetDiv= document.getElementById($targetDivId);

                // $targetDiv의 부모로 가서 existing-value 찾기
                const $existingDiv = $targetDiv.parentNode.nextSibling.nextSibling;

                if($targetDiv.style.display === 'none'){
                    $targetDiv.style.display = 'block';
                    /* 숨겨진 div 나타나면 기존 회원정보 가리기 */
                    $existingDiv.style.display = 'none';
                    const $targetInput = $targetDiv.querySelector('.form-control');

                    $targetInput.focus();

                    $targetInput.value=$existingDiv.textContent.replaceAll(' ','');
                    button.textContent = '취소';
                    button.style.backgroundColor = 'white';
                    button.style.color = 'black';
                }else{
                    /* div 숨겨지면 기존 회원정보 나타나게 하기 */
                    $existingDiv.style.display = 'block';
                    $targetDiv.style.display = 'none';
                    button.textContent = '변경';
                    button.style.backgroundColor = 'lightgrey';
                    button.style.color = 'white';
                }
            })
        })

        /* 저장 버튼 클릭 이벤트 리스너 */
        const $pwEditBtn = document.getElementById('pw-edit-btn');
        const $emailEditBtn = document.getElementById('email-edit-btn');
        const $phoneEditBtn = document.getElementById('phone-edit-btn');


        /* 기존 비밀번호 인증 */
        const $pwInput = document.getElementById('floating-input');

        document.getElementById('pw-check-btn').addEventListener('click',()=>{
            $.ajax({
                url : '/user/mypage/pwCheck',
                method : 'POST',
                data : {'memberPw' : $pwInput.value },
                dataType : 'json'
            })
                .done(function(response){
                    if(!response){
                        document.getElementById('pw-auth-alert').textContent = '비밀번호가 일치하지 않습니다';
                        $pwEditBtn.disabled = true;
                    }else{
                        document.getElementById('pw-auth-alert').textContent = '';
                        $pwEditBtn.disabled = false;
                    }
                })

                .fail(function (jqXHR, textStatus){
                    alert('통신 중 오류가 발생하였습니다');
                    console.log(`Request failed: ${textStatus}`);
                })

        })

        /* 새로운 비밀번호 저장 버튼 클릭시 : 유효성 검사 + 새 비밀번호 일치 확인 모두 만족시 비밀번호 update */
        let $newPw = document.getElementById('new-pw');
        $pwEditBtn.addEventListener('click',function(){
            const $pwCheckAlert = document.getElementById('pw-check-alert');
            // 1. 유효성 검사 통과 못 한 경우
            const $inputEles = $pwEditDiv.querySelectorAll('.form-control');
            let isValid = Array.from($inputEles).every(inputEle => validationCheck(inputEle));
            console.log(isValid);
            if(!isValid){
                $pwCheckAlert.textContent = '유효한 값을 입력해 주세요';
            } else{
                // 2. 기존 비밀번호와 동일하진 않은지 확인
                if($pwInput.value === $newPw.value){
                    $pwCheckAlert.textContent = '기존 비밀번호와 다른 값을 입력해 주세요';
                    $newPw.focus();
                } else {
                    $pwCheckAlert.textContent = '';
                    // 3. 유효성 검사 통과하면 새 비밀번호 일치 여부 확인
                    if($newPw.value === document.getElementById('new-pw-check').value){
                        $pwCheckAlert.textContent = '';
                        // 비밀번호 UPDATE
                        $.ajax({
                            url : '/user/mypage/pwModify',
                            method : 'POST',
                            data : { 'memberPw': document.getElementById('new-pw').value },
                            dataType : 'json'
                        })
                            .done(function(response){
                                if(response.result == 1) alert('비밀번호가 정상적으로 변경되었습니다.'); else alert('비밀번호 변경에 실패하였습니다');
                            })

                            .fail(function(jqXHR, textStatus){
                                alert('통신 중 오류가 발생하였습니다');
                                console.log(`Request failed: ${textStatus}`);
                            })
                    } else {
                        $pwCheckAlert.textContent = '비밀번호가 서로 일치하지 않습니다.';
                        document.getElementById('new-pw-check').focus();

                    }
                }
            }
        })

        /* 이메일 저장 버튼 클릭시 update */

        /* 휴대폰번호 저장 버튼 클릭시 update */

        /* 입력란 유효성 검사 함수 */
        function validationCheck(input){
            let isValid = true;
            if( input.value.trim() === '' || typeof input === 'undefined' || input.value == null ){
                isValid = false;
                input.nextElementSibling.textContent = '유효한 값이 아닙니다';
            }
            return isValid;
        }


        //====================상민======================

        let selectFund = [[${selectFund}]];

        $('.fundCategory').each((idx,item)=>{
            if($(item).val() === selectFund) {
                $(item).prop('selected',true);
                return false;
            }
        })
        //펀딩 내역 셀렉트 박스
        $('#selectFund').change(function(){
            selectFund = $(this).val();
            console.log(selectFund);
            location.href = `/user/mypage/?selectFund=${selectFund}`;
        })

    </script>
</th:block>


</body>
</html>