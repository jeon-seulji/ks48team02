<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{user/layout/login_default}">
<!--로그인 후 볼 수 있는 유저 마이 페이지-->
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.1/font/bootstrap-icons.css">
    <style>
        .login-logo .user-connection-menu {
            display: none;
        }

        .nav-link{
            font-size: medium;
        }

        #profileContainer{
            display: flex;
            justify-content: center;
            padding: 35px;
            flex-direction: column;
        }

        #img-box{
            margin: 0 auto;
        }

        #name-box{
            display: flex;
            justify-content: center;
            flex-direction: row;
        }
    </style>

</head>
<body>
<!--사용자별 html-->
<th:block layout:fragment="customContents">
    <!-- 유저 프로필 영역   -->
    <div id="profileContainer">
        <!-- 프로필 이미지 -->
        <div id="img-box">
            <img style="width: 90px; height: 90px; border-radius: 50%;" src="https://search.pstatic.net/sunny/?src=https%3A%2F%2Fi.namu.wiki%2Fi%2FDgDM89CJAmUv4KwG-JNwQOWklX6MPKPXip-KQL66igwbwegZ3y6pRdFZ3Ne28Qn7JaxXZzewB3_iHM_uqJ7s8A.webp&type=sc960_832"
                 id="profile_img" alt="">
        </div>

        <!-- 사용자 이름 + 설정 아이콘 -->
        <div id="name-box">
            <!-- 사용자 이름 -->
            <h2>최미미</h2>
            <!-- 설정 아이콘 클릭시 프로필 설정 페이지로 이동  -->
            <a th:href="@{/user/mypage/profile}"><i class="bi bi-gear" id="showProfileIcon" ></i></a>

        </div>
    </div>
    <!-- tab 메뉴 영역  -->
    <!-- data-toggle="tab" 속성을 Bootstrap의 <a> 태그에 추가하면 해당 링크가 tab 컴포넌트를 제어하도록 설정 -->
    <div class="row mb-lg-5" >
        <div class="col-lg-4"></div>

        <div  id="cancelResult" class="col-lg-4 main_container" style="display: block;">
            <div class="border border-secondary rounded bg-light mb-lg-3 d-flex justify-content-center row">
                <h3 class="text-dark my-lg-2">상품 선택 후 사유를 입력해주세요.</h3>
            </div>

            <div class="border border-secondary rounded py-lg-3 px-lg-2 row">
                <div class="col-lg-12">
                    <input type="checkbox" id="allCheck">
                    <label for="allCheck" class="text-dark font-weight-bold" style="margin-bottom: 0rem;">전체 체크</label>

                    <hr style="color: #5a6268; size:1px">

                    <ul id="orderList">
                        <li>
                            <div class="options my-lg-2 ml-lg-3 row">
                            <span>
                                <input type="checkbox" id="option1" class="optionCheck">
                            </span>
                                <span class="text-white">
                                <label for="option1">
                                    <div class="rewardProjectImage bg-primary rounded-circle text-center ml-lg-2" style="height: 80px; width: 80px" ><br>상품사진</div>
                                </label>
                            </span>
                                <span class="text-dark ml-lg-3">
                                <p class="rewardProjectName">프로젝트 제목</p>
                                <p class="rewardOptionName">프로젝트 옵션1 이름</p>
                                <p><span class="rewardOrderPrice font-weight-bold">30,000</span>원</p>
                                <p>주문수량 : <span class="rewardOptionAmount font-weight-bold">1</span>개</p>
                                <p>배송비 : <span class="rewardOptionDeliverPrice font-weight-bold">무료배송</span></p>
                            </span>
                            </div>
                            <hr style="color: #5a6268; size:1px">
                        </li>

                        <li>
                            <div class="options my-lg-2 ml-lg-3 row">
                            <span>
                                <input type="checkbox" id="option2" class="optionCheck">
                            </span>
                                <span class="text-white">
                                <label for="option2">
                                    <div class="rewardProjectImage bg-primary rounded-circle text-center ml-lg-2" style="height: 80px; width: 80px" ><br>상품사진</div>
                                </label>
                            </span>
                                <span class="text-dark ml-lg-3">
                                <p class="rewardProjectName">프로젝트 제목</p>
                                <p class="rewardOptionName">프로젝트 옵션2 이름</p>
                                <p><span class="rewardOrderPrice font-weight-bold">30,000</span>원</p>
                                <p>주문수량 : <span class="rewardOptionAmount font-weight-bold">1</span>개</p>
                                <p>배송비 : <span class="rewardOptionDeliverPrice font-weight-bold">무료배송</span></p>

                            </span>
                            </div>
                            <hr style="color: #5a6268; size:1px">
                        </li>
                    </ul>
                </div>

                <br>
                <p class="text-center text-dark font-weight-bold ml-lg-4 mr-lg-5"> 취소 사유</p>


                <div class="col-lg-4">

                    <div class="form-check text-center mt-lg-2">

                        <label class="btn btn-light btn-outline-dark w-100" for="result1" style="border-radius: 5px;">
                            <input type="radio" class="btn-check" name="options" id="result1" checked>
                            단순 변심
                        </label>
                        <br>

                        <label class="btn btn-light btn-outline-dark w-100" for="result2" style="border-radius: 5px;">
                            <input type="radio" class="btn-check" name="options" id="result2">
                            주문 실수
                        </label>
                    </div>
                </div>
                <div class="col-lg-4">

                    <div class="form-check text-center mt-lg-2">

                        <label class="btn btn-light btn-outline-dark w-100" for="result3" style="border-radius: 5px;">
                            <input type="radio" class="btn-check" name="options" id="result3">
                            배송 지연
                        </label>
                        <br>

                        <label class="btn btn-light btn-outline-dark w-100" for="result4" style="border-radius: 5px;">
                            <input type="radio" class="btn-check" name="options" id="result4">
                            서비스 불만족
                        </label>
                    </div>
                </div>

                <div class="col-lg-12 text-dark">
                    <hr style="color: #5a6268;">
                    <p class="font-weight-bold ml-lg-2">상세 사유 입력</p>
                    <textarea rows="5" class="w-100 rounded"></textarea>

                    <hr style="color: #5a6268; size:1px">

                    <h4>취소 예정 금액 : <span id="cancelTotalPrice" class="text-primary"></span>원</h4>

                    <hr style="color: #5a6268; size:1px">

                    <div class="d-flex justify-content-center my-lg-3">

                        <button class="cancelBtn btn btn-primary w-50 mt-lg-3">취소 신청</button>
                    </div>

                </div>
            </div>

            <div class="mt-lg-3">

                <strong class="text-danger">◈확인해주세요.</strong>

                <p>주문 취소는 상품이 출고 되기 전에만 가능하며 상품 출고 후에는 반품 및 회수 절차를 따르게 됩니다. </p>
                <p>주문 취소는 취소 사유를 입력하시면 보다 신속하게 취소 처리 진행됩니다.</p>
                <p>주 결제수단(카드,계좌,휴대폰 등)과 보조 결제수단(네이버페이 포인트)를 복합결제 후 환불요청 시, 취소 우선순위에 따라 주 결제수단에서 선 취소 처리됩니다.</p>
                <p>카드사 결제할인 적용 주문에 사용된 포인트는 취소 즉시 자동 회수되므로, <b>취소 후 계정으로 반환되지 않습니다.</b></p>
            </div>
        </div>

    </div>





</th:block>

<!-- 사용자별 스크립트 파일 -->
<th:block layout:fragment="customJsFile">
    <script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
    <!--  다음 주소찾기 api   -->


</th:block>

<!-- 사용자별 스크립트 작성 -->
<th:block layout:fragment="customJsCode">

    <script>
        $(function(){

            //전체체크 클릭 시 주문한 상품 모두 선택, 취소 예정 금액 변경
            $('#allCheck').click(function(){
                let cancelTotalPrice = 0;

                $('#orderList').find('input[type="checkbox"]').prop('checked',$(this).prop('checked'));

                if($(this).prop('checked')) {
                    $('.rewardOrderPrice').each((idx,item)=>{
                        cancelTotalPrice +=  Number($(item).text().replaceAll(',',''));
                    })
                }
                $('#cancelTotalPrice').text(cancelTotalPrice.toLocaleString('ko-KR'));
            });


            //주문한 상품 클릭 시 모두 클릭되면 전체체크 체크, 아니면 체크 해지, + 취소 예정 금액 변경
            $('.optionCheck').change(function(){
                let optionLength = $('.optionCheck').length;
                let checkedLength = $('.optionCheck:checked').length;
                let isAllcheck = optionLength === checkedLength;
                let cancelTotalPrice = 0;
                let selectedRefundOption = $('.optionCheck:checked').parents('.options');

                $('#allCheck').prop('checked',isAllcheck);

                $(selectedRefundOption).each((idx, item) => {
                    cancelTotalPrice += Number($(item).find('.rewardOrderPrice').text().replaceAll(',',''));
                });

                $('#cancelTotalPrice').text(cancelTotalPrice.toLocaleString('ko-KR'));
            });

            //취소 신청 클릭시 상품 체크되었는지 확인
            $('.cancelBtn').click(function(){

                let checkedLength = $('.optionCheck:checked').length;

                if(checkedLength < 1) {
                    $('#allCheck').focus();
                    alert('취소할 상품을 선택해주세요')
                } else if(confirm('정말로 취소하시겠습니까?')) {
                    //취소 절차 진행
                }


            });

        });
    </script>



</th:block>


</body>
</html>